<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Analysis Results | Resume Analyzer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>Analysis Results</h1>
            <p>Comprehensive AI-powered analysis of your resume</p>
            <div class="header-actions">
                <a href="/edit-resume/{{ filename }}" class="btn-primary">
                    <i class='bx bx-edit'></i> Edit Resume
                </a>
                <a href="/" class="btn-secondary">
                    <i class='bx bx-left-arrow-alt'></i> New Analysis
                </a>
            </div>
        </header>

        <main>
            <div class="results-container">
                {% if results.match_percentage > 0 %}
                <div class="card">
                    <h2><i class='bx bx-target-lock'></i> Job Match Score</h2>
                    <div class="score-card">
                        <div class="score-details">
                            <div class="score-title">Match Percentage</div>
                            <div class="score-value">{{ results.match_percentage }}%</div>
                        </div>
                        <div class="score-container">
                            <div class="progress-bar">
                                <div class="progress" style="width: {{ results.match_percentage }}%"></div>
                            </div>
                        </div>
                        <div class="score-message">
                            {% if results.match_percentage >= 80 %}
                            <div class="score-great"><i class='bx bxs-check-circle'></i> Excellent match! Your resume aligns well with this job.</div>
                            {% elif results.match_percentage >= 60 %}
                            <div class="score-good"><i class='bx bxs-check-circle'></i> Good match! Consider addressing the missing skills.</div>
                            {% elif results.match_percentage >= 40 %}
                            <div class="score-average"><i class='bx bxs-info-circle'></i> Average match. Try to incorporate more relevant skills.</div>
                            {% else %}
                            <div class="score-poor"><i class='bx bxs-error'></i> Low match. Your resume needs significant updates for this role.</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    {% if results.semantic_similarity %}
                    <div class="semantic-score" style="margin-top: 2rem;">
                        <h3><i class='bx bx-brain'></i> Semantic Similarity</h3>
                        <div class="similarity-bar" style="background: var(--bg-tertiary); border-radius: var(--radius-xl); height: 12px; overflow: hidden; margin: 1rem 0;">
                            <div class="similarity-progress" style="height: 100%; background: linear-gradient(90deg, var(--primary-color), var(--primary-light)); border-radius: var(--radius-xl); transition: width 0.6s ease; width: {{ (results.semantic_similarity * 100)|round(1) }}%"></div>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.875rem;">Content alignment: {{ (results.semantic_similarity * 100)|round(1) }}%</p>
                    </div>
                    {% endif %}
                </div>
                {% endif %}

                <!-- Advanced Analytics Section -->
                <div class="card">
                    <h2><i class='bx bx-bar-chart-alt-2'></i> Advanced Analytics</h2>
                    <div class="analytics-grid">
                        
                        <!-- Sentiment Analysis -->
                        {% if results.sentiment %}
                        <div class="analytics-card">
                            <h3><i class='bx bx-smile'></i> Sentiment Analysis</h3>
                            <div class="sentiment-result">
                                {% if results.sentiment.label == 'POSITIVE' %}
                                <span class="sentiment positive">
                                    <i class='bx bxs-happy'></i> Positive ({{ (results.sentiment.score * 100)|round(1) }}%)
                                </span>
                                {% elif results.sentiment.label == 'NEGATIVE' %}
                                <span class="sentiment negative">
                                    <i class='bx bxs-sad'></i> Negative ({{ (results.sentiment.score * 100)|round(1) }}%)
                                </span>
                                {% else %}
                                <span class="sentiment neutral">
                                    <i class='bx bxs-meh'></i> Neutral ({{ (results.sentiment.score * 100)|round(1) }}%)
                                </span>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}

                        <!-- Readability Scores -->
                        {% if results.readability %}
                        <div class="analytics-card">
                            <h3><i class='bx bx-book-reader'></i> Readability</h3>
                            <div class="readability-scores">
                                {% if results.readability.flesch_reading_ease %}
                                <div class="score-item">
                                    <span class="label">Reading Ease:</span>
                                    <span class="value">{{ results.readability.flesch_reading_ease|round(1) }}/100</span>
                                </div>
                                {% endif %}
                                {% if results.readability.flesch_kincaid_grade %}
                                <div class="score-item">
                                    <span class="label">Grade Level:</span>
                                    <span class="value">{{ results.readability.flesch_kincaid_grade|round(1) }}</span>
                                </div>
                                {% endif %}
                                {% if results.readability.reading_time %}
                                <div class="score-item">
                                    <span class="label">Reading Time:</span>
                                    <span class="value">{{ results.readability.reading_time|round(1) }} min</span>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}

                        <!-- Text Statistics -->
                        {% if results.advanced_insights %}
                        <div class="analytics-card">
                            <h3><i class='bx bx-stats'></i> Text Statistics</h3>
                            <div class="stats-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                                <div class="stat-item" style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: var(--radius-md);">
                                    <span class="number" style="display: block; font-size: 1.5rem; font-weight: 700; color: var(--primary-color);">{{ results.advanced_insights.word_count }}</span>
                                    <span class="label" style="color: var(--text-secondary); font-size: 0.875rem;">Words</span>
                                </div>
                                <div class="stat-item" style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: var(--radius-md);">
                                    <span class="number" style="display: block; font-size: 1.5rem; font-weight: 700; color: var(--primary-color);">{{ results.advanced_insights.sentence_count }}</span>
                                    <span class="label" style="color: var(--text-secondary); font-size: 0.875rem;">Sentences</span>
                                </div>
                                <div class="stat-item" style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: var(--radius-md);">
                                    <span class="number" style="display: block; font-size: 1.5rem; font-weight: 700; color: var(--primary-color);">{{ results.advanced_insights.total_skills }}</span>
                                    <span class="label" style="color: var(--text-secondary); font-size: 0.875rem;">Skills Found</span>
                                </div>
                                <div class="stat-item" style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: var(--radius-md);">
                                    <span class="number" style="display: block; font-size: 1.5rem; font-weight: 700; color: var(--primary-color);">{{ results.advanced_insights.total_entities }}</span>
                                    <span class="label" style="color: var(--text-secondary); font-size: 0.875rem;">Entities</span>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Skills Section -->
                <div class="card">
                    <h2><i class='bx bx-check-circle'></i> Skills Analysis</h2>
                    
                    {% if results.skills %}
                    <div class="skills-grid">
                        {% for category, skills_list in results.skills.items() %}
                        {% if skills_list %}
                        <div class="skill-category">
                            <h4>
                                {% if category == 'technical_skills' %}
                                <i class='bx bx-code-alt'></i> Technical Skills
                                {% elif category == 'soft_skills' %}
                                <i class='bx bx-heart'></i> Soft Skills
                                {% else %}
                                <i class='bx bx-category'></i> {{ category.replace('_', ' ').title() }}
                                {% endif %}
                            </h4>
                            <div class="skill-list">
                                {% for skill_obj in skills_list %}
                                <span class="skill-tag" title="Confidence: {{ (skill_obj.confidence * 100)|round }}%">
                                    {{ skill_obj.skill }}
                                </span>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    {% else %}
                    <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                        <i class='bx bx-info-circle' style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>No specific skills detected. Consider adding more technical keywords to your resume.</p>
                    </div>
                    {% endif %}
                </div>

                {% if results.missing_skills %}
                <div class="card">
                    <h2><i class='bx bx-plus-circle'></i> Missing Skills</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 2rem;">Skills found in the job description but not in your resume:</p>
                    
                    {% for category, missing_list in results.missing_skills.items() %}
                    {% if missing_list %}
                    <div class="skill-category">
                        <h4>
                            {% if category == 'technical_skills' %}
                            <i class='bx bx-code-alt'></i> Technical Skills
                            {% elif category == 'soft_skills' %}
                            <i class='bx bx-heart'></i> Soft Skills
                            {% else %}
                            <i class='bx bx-category'></i> {{ category.replace('_', ' ').title() }}
                            {% endif %}
                        </h4>
                        <div class="skill-list">
                            {% for skill in missing_list %}
                            <span class="skill-tag" style="background: rgba(239, 68, 68, 0.1); color: var(--danger-color); border: 1px solid rgba(239, 68, 68, 0.2);">
                                {{ skill }}
                            </span>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endif %}

                {% if results.entities %}
                <div class="card">
                    <h2><i class='bx bx-sitemap'></i> Entities Detected</h2>
                    <div class="entity-grid">
                        {% for entity in results.entities %}
                        <div class="entity-item">
                            <div class="entity-type">{{ entity.label }}</div>
                            <div class="entity-value">{{ entity.text }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                {% if results.improvement_suggestions %}
                <div class="card">
                    <h2><i class='bx bx-lightbulb'></i> Improvement Suggestions</h2>
                    <div class="suggestions-grid">
                        {% for suggestion in results.improvement_suggestions %}
                        <div class="suggestion-card priority-{{ suggestion.priority }}">
                            <div class="priority-badge priority-{{ suggestion.priority }}">
                                {{ suggestion.priority }} Priority
                            </div>
                            <h4>{{ suggestion.title }}</h4>
                            <p>{{ suggestion.description }}</p>
                            {% if suggestion.impact %}
                            <div class="impact-note">
                                <i class='bx bx-info-circle'></i>
                                <span>{{ suggestion.impact }}</span>
                            </div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </main>

        <footer>
            <p>&copy; 2025 Resume Analyzer | AI-Powered Resume Analysis Tool</p>
        </footer>
    </div>
</body>

</html>